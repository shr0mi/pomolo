<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.effect.DropShadow?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<StackPane xmlns:fx="http://javafx.com/fxml"
           xmlns:ikonli="org.kordamp.ikonli.javafx"
           fx:controller="pages.mini_player.miniPlayerController"
           fx:id="root"
           prefWidth="300" prefHeight="300"
           styleClass="mini-player-root" stylesheets="@/css/dark-theme.css">

    <children>
        <!-- === Glow Ring === -->
        <Circle fx:id="glowRing"
                radius="135"
                stroke="white"
                strokeWidth="3"
                fill="transparent">
            <effect>
                <DropShadow radius="25" color="white" spread="0.3"/>
            </effect>
        </Circle>

        <!-- === Pomodoro Progress Ring === -->
        <StackPane fx:id="ringVisualsStack" alignment="CENTER">
            <Circle fill="transparent" radius="110.0" stroke="#FFFFFF66" strokeWidth="4.0" />
            <Circle fx:id="timerProgressRing" fill="transparent" radius="110.0" stroke="#FFFFFF" strokeLineCap="ROUND" strokeWidth="10.0" />
        </StackPane>

        <!-- === Music Design (shown when not hovered) === -->
        <StackPane fx:id="musicDesign" alignment="CENTER">
            <Circle fx:id="visualCircle"
                    radius="100"
                    fill="#8A6FAD"
                    opacity="0.15" />
        </StackPane>

        <!-- === Main UI (shown when hovered) === -->
        <StackPane fx:id="uiContainer" alignment="CENTER">
            <VBox alignment="CENTER" spacing="18">
                <Label text="ðŸŽµ" styleClass="mini-player-icon-label" />

                <Label fx:id="songLabel"
                       text="Now Playing"
                       styleClass="mini-player-song-label" />

                <HBox alignment="CENTER" spacing="20">
                    <Button fx:id="prevButton"
                            onAction="#previous"
                            styleClass="mini-player-control-button">
                        <graphic>
                            <FontIcon iconLiteral="fas-backward" />
                        </graphic>
                    </Button>

                    <Button fx:id="playPauseButton"
                            onAction="#playPause"
                            styleClass="mini-player-play-button">
                        <graphic>
                            <FontIcon fx:id="playPauseIcon" iconLiteral="fas-play" />
                        </graphic>
                    </Button>

                    <Button fx:id="nextButton"
                            onAction="#next"
                            styleClass="mini-player-control-button">
                        <graphic>
                            <FontIcon iconLiteral="fas-forward" />
                        </graphic>
                    </Button>
                </HBox>

                <!-- Ambient control row placed under main controls -->
                <HBox alignment="CENTER" spacing="8">
                    <children>
                        <Button fx:id="ambientButton" mnemonicParsing="false" onAction="#handleAmbientMini" styleClass="mini-player-control-button">
                            <graphic>
                                <FontIcon iconLiteral="fas-tree" />
                            </graphic>
                        </Button>
                    </children>
                </HBox>

                <Button text="â¤´ Restore"
                        onAction="#restoreMain"
                        styleClass="mini-player-restore-button" />
            </VBox>
        </StackPane>
    </children>
</StackPane>
