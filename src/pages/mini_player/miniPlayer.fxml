<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.effect.DropShadow?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<StackPane xmlns:fx="http://javafx.com/fxml"
           xmlns:ikonli="org.kordamp.ikonli.javafx"
           fx:controller="pages.mini_player.miniPlayerController"
           fx:id="root"
           prefWidth="300" prefHeight="300"
           styleClass="mini-player-root" stylesheets="@/css/dark-theme.css">

    <children>
        <!-- === Glow Ring === -->
        <Circle fx:id="glowRing"
                radius="135"
                stroke="white"
                strokeWidth="3"
                fill="transparent">
            <effect>
                <DropShadow radius="25" color="white" spread="0.3"/>
            </effect>
        </Circle>

        <!-- === Pomodoro Progress Ring === -->
        <StackPane fx:id="ringVisualsStack" alignment="CENTER">
            <Circle fill="transparent" radius="110.0" stroke="#FFFFFF66" strokeWidth="4.0" />
            <Circle fx:id="timerProgressRing" fill="transparent" radius="110.0" stroke="#FFFFFF" strokeLineCap="ROUND" strokeWidth="10.0" />
        </StackPane>

        <!-- === Music Design (shown when not hovered) === -->
        <StackPane fx:id="musicDesign" alignment="CENTER">
            <Circle fx:id="visualCircle"
                    radius="100"
                    fill="#8A6FAD"
                    opacity="0.15" />
        </StackPane>

        <!-- === Main UI (shown when hovered) === -->
        <StackPane fx:id="uiContainer" alignment="CENTER">
            <BorderPane>
                <top>
                    <Label fx:id="songLabel"
                           text="Now Playing"
                           styleClass="mini-player-song-label"
                           wrapText="true"
                           textAlignment="CENTER"
                           maxWidth="200"
                           BorderPane.alignment="CENTER">
                        <BorderPane.margin>
                            <Insets top="60"/>
                        </BorderPane.margin>
                    </Label>
                </top>
                <center>
                    <GridPane alignment="CENTER" hgap="10" vgap="10">
                        <padding>
                            <Insets top="20" bottom="20"/>
                        </padding>
                        <children>
                            <Button onAction="#restoreMain" styleClass="mini-player-control-button" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                <graphic>
                                    <FontIcon iconLiteral="fas-level-up-alt" />
                                </graphic>
                            </Button>

                            <Button fx:id="prevButton" onAction="#previous" styleClass="mini-player-control-button" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                <graphic>
                                    <FontIcon iconLiteral="fas-backward" />
                                </graphic>
                            </Button>

                            <Button fx:id="playPauseButton" onAction="#playPause" styleClass="mini-player-play-button" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                <graphic>
                                    <FontIcon fx:id="playPauseIcon" iconLiteral="fas-play" />
                                </graphic>
                            </Button>

                            <Button fx:id="nextButton" onAction="#next" styleClass="mini-player-control-button" GridPane.columnIndex="2" GridPane.rowIndex="1">
                                <graphic>
                                    <FontIcon iconLiteral="fas-forward" />
                                </graphic>
                            </Button>

                            <Button fx:id="ambientButton" mnemonicParsing="false" onAction="#handleAmbientMini" styleClass="mini-player-control-button" GridPane.columnIndex="1" GridPane.rowIndex="2">
                                <graphic>
                                    <FontIcon iconLiteral="fas-tree" />
                                </graphic>
                            </Button>
                        </children>
                        <columnConstraints>
                            <ColumnConstraints halignment="CENTER" />
                            <ColumnConstraints halignment="CENTER" />
                            <ColumnConstraints halignment="CENTER" />
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints valignment="CENTER" />
                            <RowConstraints valignment="CENTER" />
                            <RowConstraints valignment="CENTER" />
                        </rowConstraints>
                    </GridPane>
                </center>
            </BorderPane>
        </StackPane>
    </children>
</StackPane>
